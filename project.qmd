---
title: "Stat Project"
subtitle: ""
authors: "Ema, Eileen, Elsie"
format: pdf
knitr:
  opts_chunk: 
    echo: false
    warning: false
    message: false
    fig.width: 4
    fig.height: 3
---

Initial setup:
```{r}
library(tidyverse)
library(ggplot2)

proj_data <- read.csv("sample_101_Life-Expectancy-Data-Updated.csv")
proj_data |>
  mutate(Economy_status_Developed = as.factor(Economy_status_Developed))
```

## Introduction
HERE


Dataset variables:
Country: A list of 179 distinct countries included in the dataset.
Region: Categorises the 179 countries into 9 geographical regions, such as Africa, Asia, Oceania, and the European Union.
Year: The observed year, ranging from 2000 to 2015.
Infant_deaths: Represents the number of infant deaths per 1,000 population.
Under_five_deaths: Represents the number of deaths of children under five years old per 1,000 population.
Adult_mortality: Represents the number of deaths of adults per 1,000 population.
Alcohol_consumption: Records alcohol consumption in litres of pure alcohol per capita for individuals aged 15 years and over.
Hepatitis_B: Represents the percentage of coverage for Hepatitis B (HepB3) immunisation among 1-year-olds.
Measles: Represents the percentage of coverage for Measles containing vaccine first dose (MCV1) immunisation among 1-year-olds.
BMI: Body Mass Index, a measure of nutritional status in adults (defined as a person's weight in kilograms divided by the square of that person's height in meters).
Polio: Represents the percentage of coverage for Polio (Pol3) immunisation among 1-year-olds.
Diphtheria: Represents the percentage of coverage for Diphtheria tetanus toxoid and pertussis (DTP3) immunisation among 1-year-olds.
Incidents_HIV: Represents the incidents of HIV per 1,000 population aged 15-49.
GDP_per_capita: Gross Domestic Product per capita in current US Dollars.
Population_mln: Total population of a country in millions.
Thinness_ten_nineteen_years: Prevalence of thinness among adolescents aged 10-19 years (specifically, BMI < -2 standard deviations below the median).
Thinness_five_nine_years: Prevalence of thinness among children aged 5-9 years (specifically, BMI < -2 standard deviations below the median).
Schooling: Average years individuals aged 25 and over have spent in formal education.
Economy_status_Developed: A binary indicator (0 or 1) denoting whether a country is classified as 'Developed'.
Economy_status_Developing: A binary indicator (0 or 1) denoting whether a country is classified as 'Developing'.
Life_expectancy: The average life expectancy for both genders across different years, from 2000 to 2015.

## Methodolody
WORDS HERE

```{r}
m3 <- lm(Life_expectancy ~ Country + Economy_status_Developed, data = proj_data)
summary(m3)
```

Assumptions:
```{r}
library(tidyverse)
library(ggplot2)

ggplot(data = proj_data, mapping = aes(x = m1$fitted.values, y = m1$residuals)) + 
  geom_point() + 
  labs(x = "Fitted values", y = "Residuals",
       title = "Fitted Values vs Residuals") + 
  geom_hline(yintercept = 0, color = "red") # add a horizontal red line at 0

ggplot(data = proj_data, mapping = aes(x = m1$residuals)) + 
  geom_histogram(color = "blue",
                 fill = "blue") + 
  labs(x = "Residuals", y = "Frequency",
       title = "Histogram of Residuals")
```

## Results
```{r}
m1 <- lm(Life_expectancy ~ Year + Infant_deaths + Under_five_deaths + Adult_mortality + Alcohol_consumption + Hepatitis_B + Measles + BMI + Polio + Diphtheria + Incidents_HIV + GDP_per_capita + Population_mln + Thinness_ten_nineteen_years + Thinness_five_nine_years + Schooling + Economy_status_Developed + Region, data = proj_data) 
summary(m1)

library(broom)
linear_regression <- tidy(m1) |>
  select(term, estimate, p.value) |>
  rename(
    Variable = term,
    Estimate = estimate,
    P_value = p.value) |>
  mutate(
    Estimate = round(Estimate, 3),
    P_value = round(P_value, 3))
print(linear_regression)

```

## Discussion